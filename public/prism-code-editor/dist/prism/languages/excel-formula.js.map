{"version":3,"file":"excel-formula.js","sources":["../../../src/prism/languages/excel-formula.js"],"sourcesContent":["import { languages } from '../core.js';\r\n\r\nlanguages['xlsx'] = languages['xls'] = languages['excel-formula'] = {\r\n\t'comment': {\r\n\t\tpattern: /(\\bn\\(\\s*)\"(?:[^\"]|\"\")*\"(?=\\s*\\))/gi,\r\n\t\tlookbehind: true,\r\n\t\tgreedy: true\r\n\t},\r\n\t'string': {\r\n\t\tpattern: /\"(?:[^\"]|\"\")*\"(?!\")/g,\r\n\t\tgreedy: true\r\n\t},\r\n\t'reference': {\r\n\t\t// https://www.ablebits.com/office-addins-blog/2015/12/08/excel-reference-another-sheet-workbook/\r\n\r\n\t\t// Sales!B2\r\n\t\t// 'Winter sales'!B2\r\n\t\t// [Sales.xlsx]Jan!B2:B5\r\n\t\t// D:\\Reports\\[Sales.xlsx]Jan!B2:B5\r\n\t\t// '[Sales.xlsx]Jan sales'!B2:B5\r\n\t\t// 'D:\\Reports\\[Sales.xlsx]Jan sales'!B2:B5\r\n\r\n\t\tpattern: /(?:'[^']*'|(?:[^\\s()[\\]{}<>*?\"';,$&]*\\[[^^\\s()[\\]{}<>*?\"']+\\])?\\w+)!/g,\r\n\t\tgreedy: true,\r\n\t\talias: 'string',\r\n\t\tinside: {\r\n\t\t\t'operator': /!$/,\r\n\t\t\t'punctuation': /'/,\r\n\t\t\t'sheet': {\r\n\t\t\t\tpattern: /[^[\\]]+$/,\r\n\t\t\t\talias: 'function'\r\n\t\t\t},\r\n\t\t\t'file': {\r\n\t\t\t\tpattern: /\\[[^[\\]]+\\]$/,\r\n\t\t\t\tinside: {\r\n\t\t\t\t\t'punctuation': /[[\\]]/\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\t'path': /[\\s\\S]+/\r\n\t\t}\r\n\t},\r\n\t'function-name': {\r\n\t\tpattern: /\\b[a-z]\\w*(?=\\()/i,\r\n\t\talias: 'builtin'\r\n\t},\r\n\t'range': {\r\n\t\tpattern: /\\$?\\b(?:[a-z]+\\$?\\d+:\\$?[a-z]+\\$?\\d+|[a-z]+:\\$?[a-z]+|\\d+:\\$?\\d+)\\b/i,\r\n\t\talias: 'selector',\r\n\t\tinside: {\r\n\t\t\t'operator': /:/,\r\n\t\t\t'cell': /\\$?[a-z]+\\$?\\d+/i,\r\n\t\t\t'column': /\\$?[a-z]+/i,\r\n\t\t\t'row': /\\$?\\d+/\r\n\t\t}\r\n\t},\r\n\t'cell': {\r\n\t\t// Excel is case insensitive, so the string \"foo1\" could be either a variable or a cell.\r\n\t\t// To combat this, we match cells case insensitive, if the contain at least one \"$\", and case sensitive otherwise.\r\n\t\tpattern: /\\b[A-Z]+\\d+\\b|\\$[a-zA-Z]+\\$?\\d+\\b|\\b[a-zA-Z]+\\$\\d+\\b/,\r\n\t\talias: 'selector'\r\n\t},\r\n\t'number': /(?:\\b\\d+(?:\\.\\d+)?|\\B\\.\\d+)(?:e[+-]?\\d+)?\\b/i,\r\n\t'boolean': /\\b(?:false|true)\\b/i,\r\n\t'operator': /[%&^,=/*+-]|<[=>]?|>=?/,\r\n\t'punctuation': /[()[\\]{};|]/\r\n};\r\n"],"names":[],"mappings":";AAEA,UAAU,MAAM,IAAI,UAAU,KAAK,IAAI,UAAU,eAAe,IAAI;AAAA,EACnE,WAAW;AAAA,IACV,SAAS;AAAA,IACT,YAAY;AAAA,IACZ,QAAQ;AAAA,EACR;AAAA,EACD,UAAU;AAAA,IACT,SAAS;AAAA,IACT,QAAQ;AAAA,EACR;AAAA,EACD,aAAa;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,IAUZ,SAAS;AAAA,IACT,QAAQ;AAAA,IACR,OAAO;AAAA,IACP,QAAQ;AAAA,MACP,YAAY;AAAA,MACZ,eAAe;AAAA,MACf,SAAS;AAAA,QACR,SAAS;AAAA,QACT,OAAO;AAAA,MACP;AAAA,MACD,QAAQ;AAAA,QACP,SAAS;AAAA,QACT,QAAQ;AAAA,UACP,eAAe;AAAA,QACf;AAAA,MACD;AAAA,MACD,QAAQ;AAAA,IACR;AAAA,EACD;AAAA,EACD,iBAAiB;AAAA,IAChB,SAAS;AAAA,IACT,OAAO;AAAA,EACP;AAAA,EACD,SAAS;AAAA,IACR,SAAS;AAAA,IACT,OAAO;AAAA,IACP,QAAQ;AAAA,MACP,YAAY;AAAA,MACZ,QAAQ;AAAA,MACR,UAAU;AAAA,MACV,OAAO;AAAA,IACP;AAAA,EACD;AAAA,EACD,QAAQ;AAAA;AAAA;AAAA,IAGP,SAAS;AAAA,IACT,OAAO;AAAA,EACP;AAAA,EACD,UAAU;AAAA,EACV,WAAW;AAAA,EACX,YAAY;AAAA,EACZ,eAAe;AAChB;"}