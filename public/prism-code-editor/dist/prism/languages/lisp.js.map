{"version":3,"file":"lisp.js","sources":["../../../src/prism/languages/lisp.js"],"sourcesContent":["import { languages, rest } from '../core.js';\r\nimport { clone } from '../utils/language.js';\r\n\r\n/**\r\n * Functions to construct regular expressions\r\n * e.g. (interactive ... or (interactive)\r\n *\r\n * @param {string} name\r\n * @returns {RegExp}\r\n */\r\nvar simple_form = name => RegExp(`(\\\\()(?:${name})(?=[\\\\s\\\\)])`);\r\n/**\r\n * booleans and numbers\r\n *\r\n * @param {string} pattern\r\n * @returns {RegExp}\r\n */\r\nvar primitive = pattern => RegExp(`([\\\\s([])(?:${pattern})(?=[\\\\s)])`);\r\n\r\n// Patterns in regular expressions\r\n\r\n// Symbol name. See https://www.gnu.org/software/emacs/manual/html_node/elisp/Symbol-Type.html\r\n// & and : are excluded as they are usually used for special purposes\r\nvar symbol = /(?!\\d)[~@$%{}\\w^!=<>/*+-]+/.source;\r\n// symbol starting with & used in function arguments\r\nvar marker = '&' + symbol;\r\n// Open parenthesis for look-behind\r\nvar par = '(\\\\()';\r\nvar endpar = '(?=\\\\))';\r\n// End the pattern with look-ahead space\r\nvar space = '(?=\\\\s)';\r\nvar nestedPar = /(?:[^()]|\\((?:[^()]|\\((?:[^()]|\\((?:[^()]|\\((?:[^()]|\\([^)]*\\))*\\))*\\))*\\))*\\))/.source;\r\n\r\nvar language = {\r\n\t// Three or four semicolons are considered a heading.\r\n\t// See https://www.gnu.org/software/emacs/manual/html_node/elisp/Comment-Tips.html\r\n\t'heading': {\r\n\t\tpattern: /;;;.*/,\r\n\t\talias: 'comment title'\r\n\t},\r\n\t'comment': /;.*/,\r\n\t'string': {\r\n\t\tpattern: /\"(?:\\\\.|[^\\\\\"])*\"/g,\r\n\t\tgreedy: true,\r\n\t\tinside: {\r\n\t\t\targument: /[-A-Z]+(?=[.,\\s])/,\r\n\t\t\tsymbol: RegExp('`' + symbol + \"'\")\r\n\t\t}\r\n\t},\r\n\t'quoted-symbol': {\r\n\t\tpattern: RegExp(\"#?'\" + symbol),\r\n\t\talias: 'variable symbol'\r\n\t},\r\n\t'lisp-property': {\r\n\t\tpattern: RegExp(':' + symbol),\r\n\t\talias: 'property'\r\n\t},\r\n\t'splice': {\r\n\t\tpattern: RegExp(',@?' + symbol),\r\n\t\talias: 'symbol variable'\r\n\t},\r\n\t'keyword': [\r\n\t\t{\r\n\t\t\tpattern: RegExp(\r\n\t\t\t\tpar +\r\n\t\t\t\t\t'(?:and|(?:cl-)?letf|cl-loop|con[ds]|error|if|(?:lexical-)?let\\\\*?|message|not|null|or|provide|require|setq|unless|use-package|when|while)' +\r\n\t\t\t\t\tspace\r\n\t\t\t),\r\n\t\t\tlookbehind: true\r\n\t\t},\r\n\t\t{\r\n\t\t\tpattern: RegExp(\r\n\t\t\t\tpar + '(?:append|by|collect|concat|do|finally|for|in|return)' + space\r\n\t\t\t),\r\n\t\t\tlookbehind: true\r\n\t\t},\r\n\t],\r\n\t'declare': {\r\n\t\tpattern: simple_form(/declare/.source),\r\n\t\tlookbehind: true,\r\n\t\talias: 'keyword'\r\n\t},\r\n\t'interactive': {\r\n\t\tpattern: simple_form(/interactive/.source),\r\n\t\tlookbehind: true,\r\n\t\talias: 'keyword'\r\n\t},\r\n\t'boolean': {\r\n\t\tpattern: primitive(/nil|t/.source),\r\n\t\tlookbehind: true\r\n\t},\r\n\t'number': {\r\n\t\tpattern: primitive(/[+-]?\\d+(?:\\.\\d*)?/.source),\r\n\t\tlookbehind: true\r\n\t},\r\n\t'defvar': {\r\n\t\tpattern: RegExp(par + 'def(?:const|custom|group|var)\\\\s+' + symbol),\r\n\t\tlookbehind: true,\r\n\t\tinside: {\r\n\t\t\t'keyword': /^def[a-z]+/,\r\n\t\t\t'variable': RegExp(symbol)\r\n\t\t}\r\n\t},\r\n\t'defun': {\r\n\t\tpattern: RegExp(`${par}(?:cl-)?(?:defmacro|defun\\\\*?)\\\\s+${symbol}\\\\s+\\\\(${nestedPar}*\\\\)`, 'g'),\r\n\t\tlookbehind: true,\r\n\t\tgreedy: true,\r\n\t\tinside: {\r\n\t\t\t'keyword': /^(?:cl-)?def\\S+/,\r\n\t\t\t// See below, this property needs to be defined later so that it can\r\n\t\t\t// reference the language object.\r\n\t\t\t'arguments': null,\r\n\t\t\t'function': {\r\n\t\t\t\tpattern: RegExp('(^\\\\s)' + symbol),\r\n\t\t\t\tlookbehind: true\r\n\t\t\t},\r\n\t\t\t'punctuation': /[()]/\r\n\t\t}\r\n\t},\r\n\t'lambda': {\r\n\t\tpattern: RegExp(par + 'lambda\\\\s+\\\\(\\\\s*(?:&?' + symbol + '(?:\\\\s+&?' + symbol + ')*\\\\s*)?\\\\)', 'g'),\r\n\t\tlookbehind: true,\r\n\t\tgreedy: true,\r\n\t\tinside: {\r\n\t\t\t'keyword': /^lambda/,\r\n\t\t\t// See below, this property needs to be defined later so that it can\r\n\t\t\t// reference the language object.\r\n\t\t\t'arguments': null,\r\n\t\t\t'punctuation': /[()]/\r\n\t\t}\r\n\t},\r\n\t'car': {\r\n\t\tpattern: RegExp(par + symbol),\r\n\t\tlookbehind: true\r\n\t},\r\n\t'punctuation': [\r\n\t\t// open paren, brackets, and close paren\r\n\t\t/['`,]\\(|[()[\\]]/,\r\n\t\t// cons\r\n\t\t{\r\n\t\t\tpattern: /(\\s)\\.(?!\\S)/,\r\n\t\t\tlookbehind: true\r\n\t\t},\r\n\t]\r\n};\r\n\r\nvar arg = {\r\n\t'lisp-marker': RegExp(marker),\r\n\t'varform': {\r\n\t\tpattern: RegExp(`\\\\(${symbol}\\\\s+(?=\\\\S)${nestedPar}*\\\\)`),\r\n\t\tinside: language\r\n\t},\r\n\t'argument': {\r\n\t\tpattern: RegExp('(^|[\\\\s(])' + symbol),\r\n\t\tlookbehind: true,\r\n\t\talias: 'variable'\r\n\t},\r\n\t[rest]: language\r\n};\r\n\r\nvar forms = '\\\\S+(?:\\\\s+\\\\S+)*';\r\n\r\nvar arglist = {\r\n\tpattern: RegExp(par + nestedPar + \"+\" + endpar),\r\n\tlookbehind: true,\r\n\tinside: {\r\n\t\t'rest-vars': {\r\n\t\t\tpattern: RegExp('&(?:body|rest)\\\\s+' + forms),\r\n\t\t\tinside: arg\r\n\t\t},\r\n\t\t'other-marker-vars': {\r\n\t\t\tpattern: RegExp('&(?:aux|optional)\\\\s+' + forms),\r\n\t\t\tinside: arg\r\n\t\t},\r\n\t\t'keys': {\r\n\t\t\tpattern: RegExp('&key\\\\s+' + forms + '(?:\\\\s+&allow-other-keys)?'),\r\n\t\t\tinside: arg\r\n\t\t},\r\n\t\t'argument': {\r\n\t\t\tpattern: RegExp(symbol),\r\n\t\t\talias: 'variable'\r\n\t\t},\r\n\t\t'punctuation': /[()]/\r\n\t}\r\n};\r\n\r\nlanguage['lambda'].inside.arguments = arglist;\r\n(language['defun'].inside.arguments = clone(arglist)).inside.sublist = arglist;\r\n\r\nlanguages['emacs-lisp'] = languages.emacs = languages.elisp = languages.lisp = language;\r\n"],"names":[],"mappings":"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"}