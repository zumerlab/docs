{"version":3,"file":"textile.js","sources":["../../../src/prism/languages/textile.js"],"sourcesContent":["import { languages } from '../core.js';\r\nimport { clone, insertBefore } from '../utils/language.js';\r\nimport { re } from '../utils/shared.js';\r\nimport './markup.js';\r\n\r\nvar replacements = ['(?:\\\\([^|()\\n]+\\\\)|\\\\[[^\\\\]\\n]+\\\\]|\\\\{[^\\n}]+\\\\})', '(?:\\\\)|\\\\((?![^|()\\n]+\\\\)))'];\r\n\r\nvar modifierTokens = {\r\n\t'css': {\r\n\t\tpattern: /\\{[^{}]+\\}/,\r\n\t\tinside: 'css'\r\n\t},\r\n\t'class-id': {\r\n\t\tpattern: /(\\()[^()]+(?=\\))/,\r\n\t\tlookbehind: true,\r\n\t\talias: 'attr-value'\r\n\t},\r\n\t'lang': {\r\n\t\tpattern: /(\\[)[^[\\]]+(?=\\])/,\r\n\t\tlookbehind: true,\r\n\t\talias: 'attr-value'\r\n\t},\r\n\t// Anything else is punctuation (the first pattern is for row/col spans inside tables)\r\n\t'punctuation': /[\\\\/]\\d+|\\S/\r\n};\r\n\r\nvar phraseInlineInside = {\r\n\t// Note: superscripts and subscripts are not handled specifically\r\n\r\n\t// *bold*, **bold**\r\n\t'bold': {\r\n\t\t// eslint-disable-next-line regexp/no-super-linear-backtracking\r\n\t\tpattern: re(/(^(\\*\\*?)<0>*).+?(?=\\2)/.source, replacements),\r\n\t\tlookbehind: true\r\n\t},\r\n\r\n\t// _italic_, __italic__\r\n\t'italic': {\r\n\t\t// eslint-disable-next-line regexp/no-super-linear-backtracking\r\n\t\tpattern: re(/(^(__?)<0>*).+?(?=\\2)/.source, replacements),\r\n\t\tlookbehind: true\r\n\t},\r\n\r\n\t// ??cite??\r\n\t'cite': {\r\n\t\t// eslint-disable-next-line regexp/no-super-linear-backtracking\r\n\t\tpattern: re(/(^\\?\\?<0>*).+?(?=\\?\\?)/.source, replacements),\r\n\t\tlookbehind: true,\r\n\t\talias: 'string'\r\n\t},\r\n\r\n\t// @code@\r\n\t'code': {\r\n\t\t// eslint-disable-next-line regexp/no-super-linear-backtracking\r\n\t\tpattern: re('(^@<0>*).+?(?=@)', replacements),\r\n\t\tlookbehind: true,\r\n\t\talias: 'keyword'\r\n\t},\r\n\r\n\t// +inserted+\r\n\t'inserted': {\r\n\t\t// eslint-disable-next-line regexp/no-super-linear-backtracking\r\n\t\tpattern: re('(^\\\\+<0>*).+?(?=\\\\+)', replacements),\r\n\t\tlookbehind: true\r\n\t},\r\n\r\n\t// -deleted-\r\n\t'deleted': {\r\n\t\t// eslint-disable-next-line regexp/no-super-linear-backtracking\r\n\t\tpattern: re('(^-<0>*).+?(?=-)', replacements),\r\n\t\tlookbehind: true\r\n\t},\r\n\r\n\t// %span%\r\n\t'span': {\r\n\t\t// eslint-disable-next-line regexp/no-super-linear-backtracking\r\n\t\tpattern: re('(^%<0>*).+?(?=%)', replacements),\r\n\t\tlookbehind: true\r\n\t},\r\n\r\n\t'modifier': {\r\n\t\tpattern: re('(^\\\\*\\\\*|__|\\\\?\\\\?|[*_%@^~+-])<0>+', replacements),\r\n\t\tlookbehind: true,\r\n\t\tinside: modifierTokens\r\n\t},\r\n\t'punctuation': /[*_%?@^~+-]+/\r\n};\r\n\r\nvar phraseTableInside = {\r\n\t'modifier': {\r\n\t\t// Modifiers for rows after the first one are\r\n\t\t// preceded by a pipe and a line feed\r\n\t\tpattern: re(/(^|\\|\\n?)(?:<0>|<1>|[<>=^~_]|[\\\\/]\\d+)+(?=\\.)/.source, replacements),\r\n\t\tlookbehind: true,\r\n\t\tinside: modifierTokens\r\n\t},\r\n\t'punctuation': /\\||^\\./\r\n};\r\n\r\nvar phraseInside = {\r\n\r\n\t// h1. Header 1\r\n\t'block-tag': {\r\n\t\tpattern: re('^[a-z]\\\\w*(?:<0>|<1>|[<>=])*\\\\.', replacements),\r\n\t\tinside: {\r\n\t\t\t'modifier': {\r\n\t\t\t\tpattern: re('(^[a-z]\\\\w*)(?:<0>|<1>|[<>=])+(?=\\\\.)', replacements),\r\n\t\t\t\tlookbehind: true,\r\n\t\t\t\tinside: modifierTokens\r\n\t\t\t},\r\n\t\t\t'tag': /^[a-z]\\w*/,\r\n\t\t\t'punctuation': /\\.$/\r\n\t\t}\r\n\t},\r\n\r\n\t// # List item\r\n\t// * List item\r\n\t'list': {\r\n\t\tpattern: re('^[*#]+<0>*\\\\s+\\\\S.*', replacements, 'm'),\r\n\t\tinside: {\r\n\t\t\t'modifier': {\r\n\t\t\t\tpattern: re('(^[*#]+)<0>+', replacements),\r\n\t\t\t\tlookbehind: true,\r\n\t\t\t\tinside: modifierTokens\r\n\t\t\t},\r\n\t\t\t'punctuation': /^[*#]+/\r\n\t\t}\r\n\t},\r\n\r\n\t// | cell | cell | cell |\r\n\t'table': {\r\n\t\t// Modifiers can be applied to the row: {color:red}.|1|2|3|\r\n\t\t// or the cell: |{color:red}.1|2|3|\r\n\t\tpattern: re(/^(?:(?:<0>|<1>|[<>=^~])+\\.\\s*)?(?:\\|(?:(?:<0>|<1>|[<>=^~_]|[\\\\/]\\d+)+\\.|(?!(?:<0>|<1>|[<>=^~_]|[\\\\/]\\d+)+\\.))[^|]*)+\\|/.source, replacements, 'm'),\r\n\t\tinside: phraseTableInside\r\n\t},\r\n\r\n\t'inline': {\r\n\t\t// eslint-disable-next-line regexp/no-super-linear-backtracking\r\n\t\tpattern: re(/(^|[^a-zA-Z\\d])(\\*\\*|__|\\?\\?|[*_%@^~+-])<0>*.+?\\2(?![a-zA-Z\\d])/.source, replacements),\r\n\t\tlookbehind: true,\r\n\t\tinside: phraseInlineInside\r\n\t},\r\n\r\n\t// [alias]http://example.com\r\n\t'link-ref': {\r\n\t\tpattern: /^\\[[^\\]]+\\]\\S+$/m,\r\n\t\tinside: {\r\n\t\t\t'string': {\r\n\t\t\t\tpattern: /(^\\[)[^\\]]+(?=\\])/,\r\n\t\t\t\tlookbehind: true\r\n\t\t\t},\r\n\t\t\t'url': {\r\n\t\t\t\tpattern: /(^\\])\\S+$/,\r\n\t\t\t\tlookbehind: true\r\n\t\t\t},\r\n\t\t\t'punctuation': /[[\\]]/\r\n\t\t}\r\n\t},\r\n\r\n\t// \"text\":http://example.com\r\n\t// \"text\":link-ref\r\n\t'link': {\r\n\t\t// eslint-disable-next-line regexp/no-super-linear-backtracking\r\n\t\tpattern: re(/\"<0>*[^\"]+\":\\S+(?=\\S)[\\w/]?/.source, replacements),\r\n\t\tinside: {\r\n\t\t\t'text': {\r\n\t\t\t\t// eslint-disable-next-line regexp/no-super-linear-backtracking\r\n\t\t\t\tpattern: re(/(^\"<0>*)[^\"]+(?=\")/.source, replacements),\r\n\t\t\t\tlookbehind: true\r\n\t\t\t},\r\n\t\t\t'modifier': {\r\n\t\t\t\tpattern: re(/(^\")<0>+/.source, replacements),\r\n\t\t\t\tlookbehind: true,\r\n\t\t\t\tinside: modifierTokens\r\n\t\t\t},\r\n\t\t\t'url': {\r\n\t\t\t\tpattern: /(:).+/,\r\n\t\t\t\tlookbehind: true\r\n\t\t\t},\r\n\t\t\t'punctuation': /[\":]/\r\n\t\t}\r\n\t},\r\n\r\n\t// !image.jpg!\r\n\t// !image.jpg(Title)!:http://example.com\r\n\t'image': {\r\n\t\tpattern: re(/!(?:<0>|<1>|[<>=])*(?![<>=])[^!\\s()]+(?:\\([^)]+\\))?!(?::\\S+(?=\\S)[\\w/]?)?/.source, replacements),\r\n\t\tinside: {\r\n\t\t\t'source': {\r\n\t\t\t\tpattern: re(/(^!(?:<0>|<1>|[<>=])*)(?![<>=])[^!\\s()]+(?:\\([^)]+\\))?(?=!)/.source, replacements),\r\n\t\t\t\tlookbehind: true,\r\n\t\t\t\talias: 'url'\r\n\t\t\t},\r\n\t\t\t'modifier': {\r\n\t\t\t\tpattern: re(/(^!)(?:<0>|<1>|[<>=])+/.source, replacements),\r\n\t\t\t\tlookbehind: true,\r\n\t\t\t\tinside: modifierTokens\r\n\t\t\t},\r\n\t\t\t'url': {\r\n\t\t\t\tpattern: /(:).+/,\r\n\t\t\t\tlookbehind: true\r\n\t\t\t},\r\n\t\t\t'punctuation': /[!:]/\r\n\t\t}\r\n\t},\r\n\r\n\t// Footnote[1]\r\n\t'footnote': {\r\n\t\tpattern: /\\b\\[\\d+\\]/,\r\n\t\talias: 'comment',\r\n\t\tinside: {\r\n\t\t\t'punctuation': /[[\\]]/\r\n\t\t}\r\n\t},\r\n\r\n\t// CSS(Cascading Style Sheet)\r\n\t'acronym': {\r\n\t\tpattern: /\\b[A-Z\\d]+\\([^)]+\\)/,\r\n\t\tinside: {\r\n\t\t\t'comment': {\r\n\t\t\t\tpattern: /(\\()[^()]+(?=\\))/,\r\n\t\t\t\tlookbehind: true\r\n\t\t\t},\r\n\t\t\t'punctuation': /[()]/\r\n\t\t}\r\n\t},\r\n\r\n\t// Prism(C)\r\n\t'mark': {\r\n\t\tpattern: /\\b\\((?:C|R|TM)\\)/,\r\n\t\talias: 'comment',\r\n\t\tinside: {\r\n\t\t\t'punctuation': /[()]/\r\n\t\t}\r\n\t}\r\n};\r\n\r\nvar textile = languages.textile = clone(languages.html);\r\n\r\n// Allow some nesting\r\nvar nestedPatterns = {};\r\n\r\ninsertBefore(textile, 'markup-bracket', {\r\n\t'phrase': {\r\n\t\tpattern: /(^|\\n)\\S[\\s\\S]*?(?=$|\\n\\n)/,\r\n\t\tlookbehind: true,\r\n\t\tinside: phraseInside\r\n\t}\r\n});\r\n\r\n['bold', 'italic', 'inserted', 'deleted', 'span'].forEach(p => phraseInlineInside[p].inside = nestedPatterns);\r\n\r\n// Allow some styles inside table cells\r\n['inline', 'link', 'image', 'footnote', 'acronym', 'mark'].forEach(p => nestedPatterns[p] = phraseTableInside[p] = phraseInside[p]);\r\n\r\n// Only allow alpha-numeric HTML tags, not XML tags\r\ntextile.tag.pattern = /<\\/?(?!\\d)[a-z\\d]+(?:\\s+[^\\s/=>]+(?:=(?:\"[^\"]*\"|'[^']'|[^\\s\"'>=]+))?)*\\s*\\/?>/gi;\r\n"],"names":[],"mappings":"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"}